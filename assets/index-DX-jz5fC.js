import{r as y,K as F,L as ne,p as x,d as H,y as ae,i as U,J as se,a as v,B as le,F as ce,x as L,T as ie,m as re,C as ue,D as de,G as fe,O as ve,P as me,E as ye,g as he}from"./index-CaEfGZCH.js";import{t as z,g as A,n as T,O as Ce,P as Oe,p as pe,f as b,c as X,h as $,l as ge,m as I,I as G,w as ke,Q as we,E as Ie,N as be,r as Pe}from"./index-DJqRQlqb.js";import{u as V}from"./use-id-Ci0CwUPt.js";import{T as M,H as Se}from"./use-route-CJRK8tQk.js";import{u as Te,O as xe}from"./index-5aqxiopl.js";import{c as Be,P as ze}from"./on-popup-reopen-CzQaAN2m.js";import{u as R}from"./use-scope-id-RDAG5ATb.js";import{L as Le}from"./index-B_M-aIUB.js";let Ee=2e3;const Ae=()=>++Ee,Z={show:Boolean,zIndex:T,overlay:z,duration:T,teleport:[String,Object],lockScroll:z,lazyRender:z,beforeClose:Function,overlayProps:Object,overlayStyle:Object,overlayClass:A,transitionAppear:Boolean,closeOnClickOverlay:z},io=Object.keys(Z);function De(e,o){return e>o?"horizontal":o>e?"vertical":""}function _e(){const e=y(0),o=y(0),t=y(0),s=y(0),n=y(0),a=y(0),l=y(""),r=y(!0),m=()=>l.value==="vertical",p=()=>l.value==="horizontal",d=()=>{t.value=0,s.value=0,n.value=0,a.value=0,l.value="",r.value=!0};return{move:f=>{const h=f.touches[0];t.value=(h.clientX<0?0:h.clientX)-e.value,s.value=h.clientY-o.value,n.value=Math.abs(t.value),a.value=Math.abs(s.value);const C=10;(!l.value||n.value<C&&a.value<C)&&(l.value=De(n.value,a.value)),r.value&&(n.value>M||a.value>M)&&(r.value=!1)},start:f=>{d(),e.value=f.touches[0].clientX,o.value=f.touches[0].clientY},reset:d,startX:e,startY:o,deltaX:t,deltaY:s,offsetX:n,offsetY:a,direction:l,isVertical:m,isHorizontal:p,isTap:r}}let P=0;const K="van-overflow-hidden";function Ne(e,o){const t=_e(),s="01",n="10",a=d=>{t.move(d);const i=t.deltaY.value>0?n:s,u=Oe(d.target,e.value),{scrollHeight:f,offsetHeight:h,scrollTop:C}=u;let O="11";C===0?O=h>=f?"00":"01":C+h>=f&&(O="10"),O!=="11"&&t.isVertical()&&!(parseInt(O,2)&parseInt(i,2))&&pe(d,!0)},l=()=>{document.addEventListener("touchstart",t.start),document.addEventListener("touchmove",a,{passive:!1}),P||document.body.classList.add(K),P++},r=()=>{P&&(document.removeEventListener("touchstart",t.start),document.removeEventListener("touchmove",a),P--,P||document.body.classList.remove(K))},m=()=>o()&&l(),p=()=>o()&&r();Ce(m),F(p),ne(p),x(o,d=>{d?l():r()})}const Me=b({},Z,{round:Boolean,position:I("center"),closeIcon:I("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:I("top-right"),destroyOnClose:Boolean,safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Re,Y]=X("popup");var Ke=H({name:Re,inheritAttrs:!1,props:Me,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:o,attrs:t,slots:s}){let n,a;const l=y(),r=y(),m=Te(()=>e.show||!e.lazyRender),p=ae(()=>{const c={zIndex:l.value};if($(e.duration)){const g=e.position==="center"?"animationDuration":"transitionDuration";c[g]=`${e.duration}s`}return c}),d=()=>{n||(n=!0,l.value=e.zIndex!==void 0?+e.zIndex:Ae(),o("open"))},i=()=>{n&&Be(e.beforeClose,{done(){n=!1,o("close"),o("update:show",!1)}})},u=c=>{o("clickOverlay",c),e.closeOnClickOverlay&&i()},f=()=>{if(e.overlay){const c=b({show:e.show,class:e.overlayClass,zIndex:l.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},e.overlayProps);return v(xe,L(c,R(),{onClick:u}),{default:s["overlay-content"]})}},h=c=>{o("clickCloseIcon",c),i()},C=()=>{if(e.closeable)return v(G,{role:"button",tabindex:0,name:e.closeIcon,class:[Y("close-icon",e.closeIconPosition),Se],classPrefix:e.iconPrefix,onClick:h},null)};let O;const J=()=>{O&&clearTimeout(O),O=setTimeout(()=>{o("opened")})},Q=()=>o("closed"),W=c=>o("keydown",c),ee=m(()=>{var c;const{destroyOnClose:g,round:E,position:B,safeAreaInsetTop:oe,safeAreaInsetBottom:te,show:N}=e;if(!(!N&&g))return ue(v("div",L({ref:r,style:p.value,role:"dialog",tabindex:0,class:[Y({round:E,[B]:B}),{"van-safe-area-top":oe,"van-safe-area-bottom":te}],onKeydown:W},t,R()),[(c=s.default)==null?void 0:c.call(s),C()]),[[de,N]])}),_=()=>{const{position:c,transition:g,transitionAppear:E}=e,B=c==="center"?"van-fade":`van-popup-slide-${c}`;return v(ie,{name:g||B,appear:E,onAfterEnter:J,onAfterLeave:Q},{default:ee})};return x(()=>e.show,c=>{c&&!n&&(d(),t.tabindex===0&&re(()=>{var g;(g=r.value)==null||g.focus()})),!c&&n&&(n=!1,o("close"))}),V({popupRef:r}),Ne(r,()=>e.show&&e.lockScroll),ge("popstate",()=>{e.closeOnPopstate&&(i(),a=!1)}),U(()=>{e.show&&d()}),se(()=>{a&&(o("update:show",!0),a=!1)}),F(()=>{e.show&&e.teleport&&(i(),a=!0)}),fe(ze,()=>e.show),()=>e.teleport?v(le,{to:e.teleport},{default:()=>[f(),_()]}):v(ce,null,[f(),_()])}});const Ye=ke(Ke);let S=0;function je(e){e?(S||document.body.classList.add("van-toast--unclickable"),S++):S&&(S--,S||document.body.classList.remove("van-toast--unclickable"))}const[Fe,k]=X("toast"),He=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay","zIndex"],Ue={icon:String,show:Boolean,type:I("text"),overlay:Boolean,message:T,iconSize:T,duration:we(2e3),position:I("middle"),teleport:[String,Object],wordBreak:String,className:A,iconPrefix:String,transition:I("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:A,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean,zIndex:T};var Xe=H({name:Fe,props:Ue,emits:["update:show"],setup(e,{emit:o,slots:t}){let s,n=!1;const a=()=>{const i=e.show&&e.forbidClick;n!==i&&(n=i,je(n))},l=i=>o("update:show",i),r=()=>{e.closeOnClick&&l(!1)},m=()=>clearTimeout(s),p=()=>{const{icon:i,type:u,iconSize:f,iconPrefix:h,loadingType:C}=e;if(i||u==="success"||u==="fail")return v(G,{name:i||u,size:f,class:k("icon"),classPrefix:h},null);if(u==="loading")return v(Le,{class:k("loading"),size:f,type:C},null)},d=()=>{const{type:i,message:u}=e;if(t.message)return v("div",{class:k("text")},[t.message()]);if($(u)&&u!=="")return i==="html"?v("div",{key:0,class:k("text"),innerHTML:String(u)},null):v("div",{class:k("text")},[u])};return x(()=>[e.show,e.forbidClick],a),x(()=>[e.show,e.type,e.message,e.duration],()=>{m(),e.show&&e.duration>0&&(s=setTimeout(()=>{l(!1)},e.duration))}),U(a),ve(a),()=>v(Ye,L({class:[k([e.position,e.wordBreak==="normal"?"break-normal":e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:r,onClosed:m,"onUpdate:show":l},Ie(e,He)),{default:()=>[p(),d()]})}});function $e(){const e=ye({show:!1}),o=n=>{e.show=n},t=n=>{b(e,n,{transitionAppear:!0}),o(!0)},s=()=>o(!1);return V({open:t,close:s,toggle:o}),{open:t,close:s,state:e,toggle:o}}function Ge(e){const o=me(e),t=document.createElement("div");return document.body.appendChild(t),{instance:o.mount(t),unmount(){o.unmount(),document.body.removeChild(t)}}}const Ve={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let w=[],Ze=!1,j=b({},Ve);const qe=new Map;function q(e){return Pe(e)?e:{message:e}}function Je(){const{instance:e}=Ge({setup(){const o=y(""),{open:t,state:s,close:n,toggle:a}=$e(),l=()=>{},r=()=>v(Xe,L(s,{onClosed:l,"onUpdate:show":a}),null);return x(o,m=>{s.message=m}),he().render=r,{open:t,close:n,message:o}}});return e}function Qe(){if(!w.length||Ze){const e=Je();w.push(e)}return w[w.length-1]}function We(e={}){if(!be)return{};const o=Qe(),t=q(e);return o.open(b({},j,qe.get(t.type||j.type),t)),o}const D=e=>o=>We(b({type:e},q(o))),ro=D("loading"),uo=D("success"),fo=D("fail"),vo=e=>{w.length&&w[0].close()};export{Ye as P,uo as a,fo as b,We as c,Z as d,$e as e,ro as f,vo as g,Ge as m,io as p,Xe as s,_e as u};
//# sourceMappingURL=index-DX-jz5fC.js.map
