{"version":3,"file":"index-DG1SH6t_.js","sources":["../../src/views/studentPhoto/index.vue"],"sourcesContent":["<template>\n  <div class=\"w-screen text-[12px] h-screen p-1\">\n    <titleHeader title=\"拍照\" :goRoute=\"() => {\n      router.go(-1)\n    }\"></titleHeader>\n    <div class=\"mt-1 p-1 rounded bg-green-200 flex flex-col justify-center items-center\">\n      <Image @click=\"containers(src)\" :src=\"src\">\n      </Image>\n      <video ref=\"videoRef\" :srcObject=\"srcObject\" autoplay playsinline\n        :style='{ \"zIndex\": srcObject ? 1 : -2, \"backgroundColor\": srcObject ? \"black\" : \"transparent\", \"display\": srcObject ? \"inline-block\" : \"none\" }'\n        class=\"fixed top-0 left-0 h-screen w-screen\">\n      </video>\n      <van-button @click=\"paizhao\" class=\"fixed! bottom-1! w-8!\"\n        :style=\"{ 'zIndex': srcObject ? 2 : -2, 'display': srcObject ? 'inline-block' : 'none' }\">拍照</van-button>\n      <div class=\"flex justify-center items-center mt-1\">\n        <van-button @click=\"media\" round type=\"success\">\n          重新拍照\n        </van-button>\n      </div>\n    </div>\n    <div @click=\"globalImage = ''\"\n      class=\"fixed top-0 z-[-1] left-0 h-screen w-screen bg-fixed bg-center bg-no-repeat bg-contain bg-black\" :style=\"{\n        backgroundImage: globalImage ? `url(${globalImage})` : `url('')`,\n        zIndex: globalImage ? 1 : -1,\n        backgroundColor: globalImage ? 'black' : 'transparent'\n      }\">\n    </div>\n  </div>\n</template>\n<script setup lang='ts'>\nimport titleHeader from '@/components/titleHeader.vue';\nimport Image from '@/components/image.vue';\nimport { ref, inject } from 'vue';\nimport type { Router } from 'vue-router';\n// import Stream from 'stream';\n// import { permission } from 'process';\nconst router = inject('router') as Router\nconst src = ref('/public/image/studentPhoto.jpg')\nconst paizhao = () => {\n  const track = srcObject.value.getVideoTracks()[0]\n  const image = new ImageCapture(track)\n  // console.log(image.takePhoto())\n  image.takePhoto().then((res) => {\n    console.log(res)\n    src.value = URL.createObjectURL(res)\n    srcObject.value.getTracks()[0].stop()\n    srcObject.value = ''\n    // srcObject.value\n    // videoRef.value.style.dispaly=\"none\"\n  }).catch(() => {\n    srcObject.value.getTracks()[0].stop()\n    srcObject.value = ''\n  })\n}\nconst globalImage = ref('')\nconst containers = (url: string) => {\n  globalImage.value = url\n}\nconst videoRef = ref<HTMLVideoElement>()\nconst srcObject = ref()\nconst media = () => {\n  if ('mediaDevices' in navigator) {\n    navigator.mediaDevices.getUserMedia({\n      video: true,\n      // audio: false\n    }).then((stream) => {\n      console.log('获取到视频流:', stream)\n      if (videoRef.value) {\n        srcObject.value = stream\n        videoRef.value.play()\n      }\n    }).catch((error: Error) => {\n      console.error('获取摄像头失败:', error)\n    })\n  } else {\n    console.error('浏览器不支持媒体设备')\n  }\n}\n// const src = ref('')\n</script>\n<style scoped lang=''>\n\n</style>\n"],"names":["router","inject","src","ref","paizhao","track","srcObject","res","globalImage","containers","url","videoRef","media","stream","error","_openBlock","_createElementBlock","_hoisted_1","_createVNode","titleHeader","_unref","_createElementVNode","_hoisted_2","Image","_cache","$event","_normalizeStyle","_component_van_button","_hoisted_4"],"mappings":"8mBAoCA,MAAMA,EAASC,EAAO,QAAQ,EACxBC,EAAMC,EAAI,gCAAgC,EAC1CC,EAAU,IAAM,CACpB,MAAMC,EAAQC,EAAU,MAAM,eAAA,EAAiB,CAAC,EAClC,IAAI,aAAaD,CAAK,EAE9B,UAAA,EAAY,KAAME,GAAQ,CAC9B,QAAQ,IAAIA,CAAG,EACfL,EAAI,MAAQ,IAAI,gBAAgBK,CAAG,EACnCD,EAAU,MAAM,UAAA,EAAY,CAAC,EAAE,KAAA,EAC/BA,EAAU,MAAQ,EAGpB,CAAC,EAAE,MAAM,IAAM,CACbA,EAAU,MAAM,UAAA,EAAY,CAAC,EAAE,KAAA,EAC/BA,EAAU,MAAQ,EACpB,CAAC,CACH,EACME,EAAcL,EAAI,EAAE,EACpBM,EAAcC,GAAgB,CAClCF,EAAY,MAAQE,CACtB,EACMC,EAAWR,EAAA,EACXG,EAAYH,EAAA,EACZS,EAAQ,IAAM,CACd,iBAAkB,UACpB,UAAU,aAAa,aAAa,CAClC,MAAO,EAAA,CAER,EAAE,KAAMC,GAAW,CAClB,QAAQ,IAAI,UAAWA,CAAM,EACzBF,EAAS,QACXL,EAAU,MAAQO,EAClBF,EAAS,MAAM,KAAA,EAEnB,CAAC,EAAE,MAAOG,GAAiB,CACzB,QAAQ,MAAM,WAAYA,CAAK,CACjC,CAAC,EAED,QAAQ,MAAM,YAAY,CAE9B,0BA5EE,OAAAC,EAAA,EAAAC,EA0BM,MA1BNC,EA0BM,CAzBJC,EAEiBC,EAAA,CAFJ,MAAM,KAAM,QAAO,IAAA,CAAgBC,EAAApB,CAAA,EAAO,GAAE,EAAA,wBAGzDqB,EAcM,MAdNC,EAcM,CAbJJ,EACQK,EAAA,CADA,QAAKC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAEhB,EAAWP,EAAA,KAAG,GAAI,IAAKA,EAAA,KAAA,kBAEtCmB,EAGQ,QAAA,SAHG,WAAJ,IAAIV,EAAY,UAAWL,EAAA,MAAW,SAAA,GAAS,YAAA,GACnD,MAAKoB,EAAA,CAAA,OAAcpB,EAAA,MAAS,EAAA,GAAA,gBAA8BA,EAAA,oCAAgDA,EAAA,MAAS,eAAA,OAAA,EACpH,MAAM,sCAAA,aAERY,EAC2GS,EAAA,CAD9F,QAAOvB,EAAS,MAAM,wBAChC,MAAKsB,EAAA,CAAA,OAAcpB,EAAA,MAAS,EAAA,GAAA,QAAsBA,EAAA,MAAS,eAAA,OAAA,CAAA,aAA8B,IAAE,CAAA,GAAAkB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAF,KAAE,EAAA,CAAA,uBAC9FH,EAIM,MAJNO,EAIM,CAHJV,EAEaS,EAAA,CAFA,QAAOf,EAAO,MAAA,GAAM,KAAK,SAAA,aAAU,IAEhD,CAAA,GAAAY,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAFgD,SAEhD,EAAA,CAAA,eAGJH,EAMM,MAAA,CANA,uBAAOb,EAAA,MAAW,IACtB,MAAM,kGAAmG,MAAKkB,EAAA,CAA6B,gBAAAlB,EAAA,aAAqBA,EAAA,KAAW,IAAA,iBAAiCA,EAAA,MAAW,EAAA,mBAAoCA,EAAA,MAAW,QAAA,aAAA"}