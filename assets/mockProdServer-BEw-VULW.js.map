{"version":3,"mappings":"wCAAA,eAAeA,EAAqBC,EAAU,CAC5C,MAAMC,EAAO,MAAKC,EAAA,IAAC,OAAO,oBAAQ,OAAAC,KAAA,OAC5B,CAAE,aAAAC,CAAY,EAAK,MAAKF,EAAA,6BAAAE,CAAA,OAAC,QAAO,qBAAgB,sBAAAA,CAAA,OACtDH,EAAK,IAAI,UAAU,OAASA,EAAK,IAAI,UAAU,KAC/CA,EAAK,IAAI,UAAU,KAAO,UAAW,CAOnC,GANI,KAAK,OAAO,MACd,KAAK,OAAO,IAAI,gBAAkB,KAAK,iBAAmB,GACtD,KAAK,eACP,KAAK,OAAO,IAAI,aAAe,KAAK,eAGpC,KAAK,OAAO,eAAgB,CAC9B,MAAMI,EAAU,GAChB,QAASC,KAAK,KAAK,OAAO,eACxBD,EAAQC,EAAE,SAAQ,EAAG,YAAW,CAAE,EAAI,KAAK,OAAO,eAAeA,CAAC,EAEpE,KAAK,OAAO,QAAU,OAAO,OAAO,GAAI,KAAK,OAAO,QAAS,CAAE,QAAAD,CAAO,CAAE,CAC1E,CACA,KAAK,OAAO,MAAM,KAAM,SAAS,CACnC,EACAJ,EAAK,IAAI,UAAU,WAAaA,EAAK,IAAI,UAAU,KACnDA,EAAK,IAAI,UAAU,KAAO,UAAW,CACnC,IAAIM,EAAe,KAAK,aACxB,KAAK,WAAW,GAAG,SAAS,EACxB,KAAK,OAAO,KACVA,IACF,KAAK,OAAO,IAAI,aAAeA,EAGrC,EACA,SAAW,CAAE,IAAAC,EAAK,OAAAC,EAAQ,SAAAC,EAAU,QAAAC,CAAO,IAAMX,EAC/CY,EAAcX,EAAMU,CAAO,EAC3BV,EAAK,KACHG,EAAaI,EAAK,OAAQ,CAAE,IAAK,EAAK,CAAE,EACxCC,GAAU,MACVI,EAA0BZ,EAAMS,CAAQ,CAC9C,CAEA,CACA,SAASI,EAAcN,EAAK,CAC1B,MAAMO,EAASP,EAAI,MAAM,GAAG,EAAE,CAAC,EAC/B,OAAKO,EAGE,KAAK,MACV,KAAO,mBAAmBA,CAAM,EAAE,QAAQ,KAAM,KAAK,EAAE,QAAQ,KAAM,KAAK,EAAE,QAAQ,KAAM,KAAK,EAAE,QAAQ,MAAO,GAAG,EAAI,IAC3H,EAJW,EAKX,CACA,SAASF,EAA0BG,EAAOC,EAAQ,CAChD,OAAO,SAASC,EAAS,CACvB,IAAIC,EAAS,KACb,GAAI,OAAOF,GAAW,WAAY,CAChC,KAAM,CAAE,KAAAG,EAAM,KAAAC,EAAM,IAAAb,EAAK,QAAAH,CAAO,EAAKa,EACrC,IAAII,EAAIF,EACR,GAAI,CACFE,EAAI,KAAK,MAAMF,CAAI,CACrB,MAAQ,CACR,CACAD,EAASF,EAAO,CACd,OAAQI,EACR,KAAMC,EACN,MAAOR,EAAcN,CAAG,EACxB,QAAAH,CACR,CAAO,CACH,MACEc,EAASF,EAEX,OAAOD,EAAM,KAAKG,CAAM,CAC1B,CACF,CACA,SAASP,EAAcW,EAAMZ,EAAU,EAAG,CACxCA,GAAWY,EAAK,MAAM,CACpB,QAAAZ,CACJ,CAAG,CACH,CClEA,MAAMa,EAAU,yCAAAtB,EAAA,kEAAAA,EAAA,oEAAAA,EAAA,0EAAAA,EAAA,2EAAAA,EAAA,sEAAAA,EAAA,gEAAAA,EAAA,gEAAAA,EAAA,kEAAAA,EAAA,+DAAAA,EAAA,6DAAAA,EAAA,+BAAAuB,CAAA,qCAAAvB,EAAA,4CAChB,eAAsBwB,GAAsB,CAC1C,MAAMC,EAAM,GACZ,UAAWC,KAAQJ,EAAS,CAC1B,MAAMK,EAAS,MAAML,EAAQI,CAAI,IAG7BC,EAAO,SAAW,MAAM,QAAQA,EAAO,OAAO,GAChDF,EAAI,KAAK,GAAGE,EAAO,OAAO,CAE9B,CACA9B,EAAqB4B,CAAG,CAC1B","names":["createProdMockServer","mockList","Mock","__vitePreload","n","pathToRegexp","headers","k","responseType","url","method","response","timeout","__setupMock__","__XHR2ExpressReqWrapper__","__param2Obj__","search","_Mock","handle","options","result","body","type","b","mock","modules","topic","setupProdMockServer","arr","path","module"],"ignoreList":[0],"sources":["../../node_modules/vite-plugin-mock/dist/client.mjs","../../src/mockProdServer.ts"],"sourcesContent":["async function createProdMockServer(mockList) {\n  const Mock = await import('mockjs');\n  const { pathToRegexp } = await import('path-to-regexp');\n  Mock.XHR.prototype.__send = Mock.XHR.prototype.send;\n  Mock.XHR.prototype.send = function() {\n    if (this.custom.xhr) {\n      this.custom.xhr.withCredentials = this.withCredentials || false;\n      if (this.responseType) {\n        this.custom.xhr.responseType = this.responseType;\n      }\n    }\n    if (this.custom.requestHeaders) {\n      const headers = {};\n      for (let k in this.custom.requestHeaders) {\n        headers[k.toString().toLowerCase()] = this.custom.requestHeaders[k];\n      }\n      this.custom.options = Object.assign({}, this.custom.options, { headers });\n    }\n    this.__send.apply(this, arguments);\n  };\n  Mock.XHR.prototype.proxy_open = Mock.XHR.prototype.open;\n  Mock.XHR.prototype.open = function() {\n    let responseType = this.responseType;\n    this.proxy_open(...arguments);\n    if (this.custom.xhr) {\n      if (responseType) {\n        this.custom.xhr.responseType = responseType;\n      }\n    }\n  };\n  for (const { url, method, response, timeout } of mockList) {\n    __setupMock__(Mock, timeout);\n    Mock.mock(\n      pathToRegexp(url, void 0, { end: false }),\n      method || \"get\",\n      __XHR2ExpressReqWrapper__(Mock, response)\n    );\n  }\n}\nfunction __param2Obj__(url) {\n  const search = url.split(\"?\")[1];\n  if (!search) {\n    return {};\n  }\n  return JSON.parse(\n    '{\"' + decodeURIComponent(search).replace(/\"/g, '\\\\\"').replace(/&/g, '\",\"').replace(/=/g, '\":\"').replace(/\\+/g, \" \") + '\"}'\n  );\n}\nfunction __XHR2ExpressReqWrapper__(_Mock, handle) {\n  return function(options) {\n    let result = null;\n    if (typeof handle === \"function\") {\n      const { body, type, url, headers } = options;\n      let b = body;\n      try {\n        b = JSON.parse(body);\n      } catch {\n      }\n      result = handle({\n        method: type,\n        body: b,\n        query: __param2Obj__(url),\n        headers\n      });\n    } else {\n      result = handle;\n    }\n    return _Mock.mock(result);\n  };\n}\nfunction __setupMock__(mock, timeout = 0) {\n  timeout && mock.setup({\n    timeout\n  });\n}\nfunction defineMockModule(fn) {\n  return fn;\n}\n\nexport { createProdMockServer, defineMockModule };\n","// import type Module from 'module'\nimport { createProdMockServer } from 'vite-plugin-mock/client'\n\n// 逐一导入您的mock.ts文件\n// 如果使用vite.mock.config.ts，只需直接导入文件\n// 可以使用 import.meta.glob功能来进行全部导入\n// import testModule from '../mock/test'\n\nconst modules = import.meta.glob('../mock/*.ts')\nexport async function setupProdMockServer() {\n  const arr = []\n  for (const path in modules) {\n    const module = await modules[path]()\n    // console.log(module.default)\n    // 检查 module.default 是否存在并且是数组\n    if (module.default && Array.isArray(module.default)) {\n      arr.push(...module.default)\n    }\n  }\n  createProdMockServer(arr)\n}\n"],"file":"mockProdServer-BEw-VULW.js"}