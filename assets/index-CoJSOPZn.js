import{t as T,c as $,u as Q,w as F,f as y,x as X,E as Z,k as ee,m as te,g as ne,n as oe,e as M,v as se,N as ae,I as le}from"./index-DT_EPXAU.js";import"./index-3wft-tOo.js";import{B as O}from"./index-DHnyOtMg.js";import"./index-BdzR02Jd.js";import{p as re,P as V,d as ie,m as ce,e as ue,c as z}from"./index-D9CtDKny.js";import{P as de}from"./index-DaVddOxt.js";import"./index-Cb6JTGd4.js";import{d as N,r as b,a,y as H,E as me,N as fe,x as W,s as q,i as ge,c as k,b as u,u as _,e as ve,F as pe,j as Be,w as j,o as P,t as K,H as he,I as xe,k as we}from"./index-DaBUA-4g.js";import{u as be}from"./use-placeholder-CAMmpZZf.js";import{u as ye}from"./use-id-Dh0-f_2L.js";import{u as Ce,r as ke,d as _e,b as Pe}from"./use-route-Cg0Zv52M.js";import{c as Se}from"./on-popup-reopen-DPhK5msm.js";import"./use-scope-id-DmZn_Ge1.js";const[Y,L]=$("action-bar"),G=Symbol(Y),Te={placeholder:Boolean,safeAreaInsetBottom:T};var Oe=N({name:Y,props:Te,setup(e,{slots:l}){const n=b(),o=be(n,L),{linkChildren:r}=Q(G);r();const g=()=>{var v;return a("div",{ref:n,class:[L(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[(v=l.default)==null?void 0:v.call(l)])};return()=>e.placeholder?o(g):g()}});const Ne=F(Oe),[Ee,De]=$("action-bar-button"),Ae=y({},ke,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var Ie=N({name:Ee,props:Ae,setup(e,{slots:l}){const n=Ce(),{parent:o,index:r}=X(G),g=H(()=>{if(o){const i=o.children[r.value-1];return!(i&&"isButton"in i)}}),v=H(()=>{if(o){const i=o.children[r.value+1];return!(i&&"isButton"in i)}});return ye({isButton:!0}),()=>{const{type:i,icon:x,text:w,color:d,loading:s,disabled:m}=e;return a(O,{class:De([i,{last:v.value,first:g.value}]),size:"large",type:i,icon:x,color:d,loading:s,disabled:m,onClick:n},{default:()=>[l.default?l.default():w]})}}});const U=F(Ie),[Re,f,S]=$("dialog"),$e=y({},ie,{title:String,theme:String,width:oe,message:[String,Function],callback:Function,allowHtml:Boolean,className:ne,transition:te("van-dialog-bounce"),messageAlign:String,closeOnPopstate:T,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:T,closeOnClickOverlay:Boolean,keyboardEnabled:T,destroyOnClose:Boolean}),Fe=[...re,"transition","closeOnPopstate","destroyOnClose"];var J=N({name:Re,props:$e,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:l,slots:n}){const o=b(),r=me({confirm:!1,cancel:!1}),g=t=>l("update:show",t),v=t=>{var c;g(!1),(c=e.callback)==null||c.call(e,t)},i=t=>()=>{e.show&&(l(t),e.beforeClose?(r[t]=!0,Se(e.beforeClose,{args:[t],done(){v(t),r[t]=!1},canceled(){r[t]=!1}})):v(t))},x=i("cancel"),w=i("confirm"),d=fe(t=>{var c,B;if(!e.keyboardEnabled||t.target!==((B=(c=o.value)==null?void 0:c.popupRef)==null?void 0:B.value))return;({Enter:e.showConfirmButton?w:M,Escape:e.showCancelButton?x:M})[t.key](),l("keydown",t)},["enter","esc"]),s=()=>{const t=n.title?n.title():e.title;if(t)return a("div",{class:f("header",{isolated:!e.message&&!n.default})},[t])},m=t=>{const{message:c,allowHtml:B,messageAlign:h}=e,C=f("message",{"has-title":t,[h]:h}),I=se(c)?c():c;return B&&typeof I=="string"?a("div",{class:C,innerHTML:I},null):a("div",{class:C},[I])},E=()=>{if(n.default)return a("div",{class:f("content")},[n.default()]);const{title:t,message:c,allowHtml:B}=e;if(c){const h=!!(t||n.title);return a("div",{key:B?1:0,class:f("content",{isolated:!h})},[m(h)])}},D=()=>a("div",{class:[Pe,f("footer")]},[e.showCancelButton&&a(O,{size:"large",text:e.cancelButtonText||S("cancel"),class:f("cancel"),style:{color:e.cancelButtonColor},loading:r.cancel,disabled:e.cancelButtonDisabled,onClick:x},null),e.showConfirmButton&&a(O,{size:"large",text:e.confirmButtonText||S("confirm"),class:[f("confirm"),{[_e]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:r.confirm,disabled:e.confirmButtonDisabled,onClick:w},null)]),A=()=>a(Ne,{class:f("footer")},{default:()=>[e.showCancelButton&&a(U,{type:"warning",text:e.cancelButtonText||S("cancel"),class:f("cancel"),color:e.cancelButtonColor,loading:r.cancel,disabled:e.cancelButtonDisabled,onClick:x},null),e.showConfirmButton&&a(U,{type:"danger",text:e.confirmButtonText||S("confirm"),class:f("confirm"),color:e.confirmButtonColor,loading:r.confirm,disabled:e.confirmButtonDisabled,onClick:w},null)]}),p=()=>n.footer?n.footer():e.theme==="round-button"?A():D();return()=>{const{width:t,title:c,theme:B,message:h,className:C}=e;return a(V,W({ref:o,role:"dialog",class:[f([B]),C],style:{width:ee(t)},tabindex:0,"aria-labelledby":c||h,onKeydown:d,"onUpdate:show":g},Z(e,Fe)),{default:()=>[s(),E(),p()]})}}});let R;const Me={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1,destroyOnClose:!1};let ze=y({},Me);function He(){({instance:R}=ce({setup(){const{state:l,toggle:n}=ue();return()=>a(J,W(l,{"onUpdate:show":n}),null)}}))}function je(e){return ae?new Promise((l,n)=>{R||He(),R.open(y({},ze,e,{callback:o=>{(o==="confirm"?l:n)(o)}}))}):Promise.resolve(void 0)}const Ke=e=>je(y({showCancelButton:!0},e));F(J);async function Le(e,l){return await q(e,l)}async function Ue(e,l,n){return await q(e,l,n)}const Ve={class:"h-screen w-screen p-2 mb-6 text-[12px] overflow-auto"},We={class:"flex justify-center relative w-full"},qe={class:"flex flex-col"},Ye={class:"mr-4"},Ge={class:"mr-1"},Je={class:"flex flex-col justify-center"},Qe={key:0,class:"text-red-500 text-[12px] mb-2 flex justify-end"},Xe={class:"fixed bottom-0 left-0 w-full pb-2 flex justify-center"},mt=N({__name:"index",setup(e){const l=ve(),n=b(!1),o=b([{id:1,role:"家长",telephone:"13733114245",login:!0},{id:2,role:"爷爷",telephone:"19839096597",login:!1}]),r=b([{text:"妈妈",value:"妈妈"},{text:"爸爸",value:"爸爸"},{text:"爷爷",value:"爷爷"},{text:"奶奶",value:"奶奶"},{text:"外公",value:"外公"},{text:"外婆",value:"外婆"}]),g=()=>{n.value=!1},v=()=>{n.value=!1};ge(()=>{Le("/api/familyMessage","get").then(d=>{d.status==200&&(o.value=d.data.data)})});const i=()=>{o.value.length==4?z({message:"最多只能添加4个家长",duration:1e3,className:["text-[12px]"]}):o.value.push({id:o.value.length+1,role:"妈妈",telephone:"13733114245",login:!1})},x=d=>{o.value.map((s,m)=>{s.id==d&&(d==1?Ke({title:"删除",message:"删除后将无法使用i家校",className:["text-[12px]","p-2","rounded","text-center"]}).then(()=>{o.value.splice(m,1)}).catch(()=>{}):o.value.splice(m,1))})},w=()=>{Ue("/api/familyMessage/save","put",{...o.value}).then(d=>{d.status==200&&(z({message:"保存成功",duration:2e3,className:["text-[12px]"]}),l.push({name:"familyPhone"}))})};return(d,s)=>{const m=le,E=de,D=V,A=O;return P(),k("div",Ve,[u("div",We,[s[3]||(s[3]=u("h1",{class:"font-black text-xs"},"2513班",-1)),a(m,{onClick:s[0]||(s[0]=p=>_(l).go(-1)),name:"arrow-left",size:"0.5rem",class:"absolute! left-0 top-0"}),s[4]||(s[4]=u("span",{class:"text-green-500 text-[14px] absolute right-0 bottom-0"},"退出班级",-1))]),u("div",qe,[s[5]||(s[5]=u("span",{class:"mb-2"},"家长信息",-1)),(P(!0),k(pe,null,Be(_(o),p=>(P(),k("div",{class:"flex items-center mb-1",key:p.id},[a(m,{onClick:t=>x(p.id),name:"clear",size:"0.7rem",color:"red",class:"mr-2"},null,8,["onClick"]),u("div",Ye,[u("div",{class:"flex items-center",onClick:s[1]||(s[1]=t=>n.value=!0)},[u("span",Ge,K(p.role),1),a(m,{name:"arrow-down",size:"0.5rem"})]),a(D,{show:_(n),"onUpdate:show":s[2]||(s[2]=t=>he(n)?n.value=t:null),position:"bottom",style:{height:"50%"}},{default:j(()=>[a(E,{class:"h-full!",columns:_(r),title:"我是学生的",onConfirm:g,onCancel:v},null,8,["columns"])]),_:1},8,["show"])]),u("div",Je,[u("span",null,K(p.telephone),1),p.login?(P(),k("span",Qe,"(当前登录身份)")):xe("",!0)])]))),128))]),u("div",{class:"flex items-center justify-center",onClick:i},[a(m,{size:"0.7rem",name:"add-o",class:"mr-0.5",color:"green"}),s[6]||(s[6]=u("span",{class:"text-green-500"},"添加更多家长",-1))]),u("div",Xe,[a(A,{type:"success",class:"w-[50%]",onClick:w},{default:j(()=>[...s[7]||(s[7]=[we("保存",-1)])]),_:1})])])}}});export{mt as default};
//# sourceMappingURL=index-CoJSOPZn.js.map
